<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تسجيل الدخول</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-auth.js"></script>
</head>
<body>
    <h1>تسجيل الدخول باستخدام Google</h1>
    <button id="login">تسجيل الدخول</button>
    <button id="logout" style="display:none;">تسجيل الخروج</button>
    <p id="status"></p>

    <script>
        // إعداد Firebase
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        // تهيئة Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.getAuth();

        // تسجيل الدخول باستخدام Google
        document.getElementById("login").addEventListener("click", async () => {
            const provider = new firebase.GoogleAuthProvider();
            try {
                const result = await firebase.signInWithPopup(auth, provider);
                const user = result.user;

                // حفظ معلومات الجلسة مع انتهاء بعد يوم واحد
                const expirationDate = new Date();
                expirationDate.setDate(expirationDate.getDate() + 1); // يوم واحد
                document.cookie = `userToken=${user.accessToken}; expires=${expirationDate.toUTCString()}; path=/`;

                document.getElementById("status").textContent = `مرحبًا ${user.displayName}`;
                document.getElementById("login").style.display = "none";
                document.getElementById("logout").style.display = "block";
            } catch (error) {
                console.error("حدث خطأ أثناء تسجيل الدخول:", error);
            }
        });

        // تسجيل الخروج
        document.getElementById("logout").addEventListener("click", () => {
            firebase.signOut(auth).then(() => {
                document.cookie = "userToken=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
                document.getElementById("status").textContent = "تم تسجيل الخروج.";
                document.getElementById("login").style.display = "block";
                document.getElementById("logout").style.display = "none";
            });
        });

        // التحقق من انتهاء صلاحية الجلسة
        window.onload = () => {
            const userToken = document.cookie
                .split("; ")
                .find(row => row.startsWith("userToken="));
            if (userToken) {
                document.getElementById("status").textContent = "تم تسجيل الدخول.";
                document.getElementById("login").style.display = "none";
                document.getElementById("logout").style.display = "block";
            }
        };
    </script>
</body>
</html>
