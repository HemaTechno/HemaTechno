<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تفاصيل السكربت</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Cairo', sans-serif;
            background: radial-gradient(circle, #1e1e2f, #121212);
            color: #fff;
            margin: 0;
            padding: 0;
        }

        .neon-title {
            text-align: center;
            font-size: 2.5rem;
            color: #0ff;
            text-shadow: 0 0 10px #0ff, 0 0 20px #0ff, 0 0 30px #0ff, 0 0 40px #00f, 0 0 70px #00f;
            margin: 20px 0;
        }

        .neon-box {
            max-width: 900px;
            margin: auto;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            box-shadow: 0 0 15px #0ff, 0 0 30px #0ff;
        }

        .description, .instructions {
            text-align: center;
            margin: 20px 0;
            font-size: 1.2rem;
        }

        .youtube-container {
            text-align: center;
            margin: 20px 0;
        }

        .youtube-container iframe {
            width: 100%;
            max-width: 800px;
            height: 450px;
            border: none;
            border-radius: 10px;
            box-shadow: 0 0 15px #ff0, 0 0 30px #ff0;
        }

        .rating, .comments-section {
            margin: 20px 0;
        }

        .rating-stars {
            text-align: center;
        }

        .rating-stars label {
            font-size: 2rem;
            color: #555;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .rating-stars input:checked ~ label,
        .rating-stars label:hover,
        .rating-stars label:hover ~ label {
            color: #ff0;
            text-shadow: 0 0 10px #ff0, 0 0 20px #ff0;
        }

        .comments {
            margin-top: 20px;
            border-top: 1px solid #444;
            padding-top: 20px;
        }

        .comment {
            background: rgba(0, 0, 0, 0.3);
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 10px;
            box-shadow: 0 0 10px #0ff;
        }

        .footer {
            text-align: center;
            padding: 10px;
            background: #121212;
            margin-top: 20px;
            color: #999;
            font-size: 0.9rem;
        }

        .footer a {
            text-decoration: none;
            color: #0ff;
        }
    </style>
</head>
<body>
    <h1 class="neon-title" id="scriptTitle">تفاصيل السكربت</h1>
    <div class="neon-box">
        <p id="scriptDescription" class="description">وصف السكربت...</p>

        <div class="instructions">
            <h2>إرشادات التثبيت</h2>
            <p id="scriptInstructions">سيتم تحميل الإرشادات...</p>
        </div>

        <div class="youtube-container">
            <iframe id="scriptVideo" src="" allowfullscreen></iframe>
        </div>

        <div class="rating">
            <h2>التقييم</h2>
            <div class="rating-stars">
                <input type="radio" id="star5" name="rating" value="5"><label for="star5">⭐</label>
                <input type="radio" id="star4" name="rating" value="4"><label for="star4">⭐</label>
                <input type="radio" id="star3" name="rating" value="3"><label for="star3">⭐</label>
                <input type="radio" id="star2" name="rating" value="2"><label for="star2">⭐</label>
                <input type="radio" id="star1" name="rating" value="1"><label for="star1">⭐</label>
            </div>
            <button onclick="submitRating()">إرسال التقييم</button>
            <p id="ratingStats"></p>
        </div>

        <div class="comments-section">
            <h2>التعليقات</h2>
            <textarea id="commentInput" rows="3" placeholder="اكتب تعليقك هنا..."></textarea>
            <button onclick="submitComment()">إرسال التعليق</button>
            <div id="comments" class="comments">
                <!-- سيتم تحميل التعليقات هنا -->
            </div>
        </div>
    </div>

    <div class="footer">
        <p>© جميع الحقوق محفوظة <a href="https://t.me/hscripts">تيم هيما تيك</a></p>
    </div>

    <script src="https://www.gstatic.com/firebasejs/10.7.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.2/firebase-firestore.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDoK427q44Fj87JhgZh2vKeUnACkjl8HDc",
            authDomain: "treng-c6027.firebaseapp.com",
            projectId: "treng-c6027",
            storageBucket: "treng-c6027.appspot.com",
            messagingSenderId: "305527546716",
            appId: "1:305527546716:web:fd072a58200f31bb42d799",
            measurementId: "G-3JFKFT2LT0"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const scriptId = new URLSearchParams(window.location.search).get("id");

        async function loadScriptDetails() {
            const doc = await db.collection("scripts").doc(scriptId).get();
            if (doc.exists) {
                const data = doc.data();
                document.getElementById("scriptTitle").textContent = data.title || "بدون عنوان";
                document.getElementById("scriptDescription").textContent = data.description || "بدون وصف";
                document.getElementById("scriptInstructions").textContent = data.instructions || "بدون إرشادات";
                document.getElementById("scriptVideo").src = data.videoUrl || "";
                loadComments();
            } else {
                alert("لم يتم العثور على السكربت.");
            }
        }

        function submitRating() {
            const rating = document.querySelector('input[name="rating"]:checked')?.value;
            if (!rating) return alert("يرجى اختيار تقييم.");
            db.collection("ratings").add({
                scriptId,
                rating: Number(rating),
                createdAt: new Date()
            }).then(() => alert("تم إرسال التقييم!"));
        }

        function loadComments() {
            db.collection("comments").where("scriptId", "==", scriptId).onSnapshot(snapshot => {
                const commentsContainer = document.getElementById("comments");
                commentsContainer.innerHTML = "";
                snapshot.forEach(doc => {
                    const data = doc.data();
                    const commentDiv = document.createElement("div");
                    commentDiv.classList.add("comment");
                    commentDiv.innerHTML = `<p><strong>${data.username || "H-Scripts User 👤"}</strong></p><p>${data.comment}</p>`;
                    commentsContainer.appendChild(commentDiv);
                });
            });
        }

        function submitComment() {
            const comment = document.getElementById("commentInput").value.trim();
            if (!comment) return alert("يرجى إدخال تعليق.");
            db.collection("comments").add({
                scriptId,
                username: "H-Scripts User 👤",
                comment,
                createdAt: new Date()
            }).then(() => {
                document.getElementById("commentInput").value = "";
                alert("تم إرسال التعليق!");
            });
        }

        loadScriptDetails();
    </script>
</body>
</html>
